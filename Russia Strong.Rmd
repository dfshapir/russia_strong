---
title: "Russia Strong"
author: "Daniel Shapiro"
date: "9/16/2020"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = FALSE)
options(scipen = 999)
library(tidyverse)
library(readxl)
library(gt)
library(scales)
```

```{r read}
strength <- read_xlsx("raw-data/strong.xlsx") %>% select(-c(`Pct Change`, Country))
strength$Value <- prettyNum(strength$Value, big.mark = ",")

nat_pwr <- read_xlsx("raw-data/national_power.xlsx")

strength <- pivot_wider(strength, names_from = Year, values_from = Value) %>%
  mutate(`Pct Change` = c(-0.07/100, 1.34/100, 4.49/100, -1.13/100, -1.55/100, 0.94/100, -0.43/100, -0.54/100, -4.49/100, -0.97/100, -0.59/100, -0.77/100
))

strength$`2018` <- as.numeric(gsub(",","",strength$`2018`,fixed=TRUE))
strength$`2019` <- as.numeric(gsub(",","",strength$`2019`,fixed=TRUE)) 
```

```{r gtstrength}
gt <- gt(strength)

gt <- gt %>% fmt_percent(columns = vars(`Pct Change`)) %>%
  fmt_number(columns = vars(`2018`), drop_trailing_zeros = TRUE) %>%
  fmt_number(columns = vars(`2019`), drop_trailing_zeros = TRUE) %>%
  fmt_percent(columns = vars(`2018`), rows = 4:12) %>%
  fmt_percent(columns = vars(`2019`), rows = 4:12)  %>%
  tab_spanner(label = "Year", columns = vars(`2018`, `2019`)) %>%
  tab_header(title = "Russian National Power Components, 2018-2019",
             subtitle = "Formula from Taiwanese scholar Chin-Lung Chang")

gt
```

